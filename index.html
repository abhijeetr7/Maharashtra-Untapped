<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maharashtra Untapped Tourism Guide (PWA)</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
        }
        /* Custom scrollbar for better visual separation */
        .scrollable-list::-webkit-scrollbar {
            width: 6px;
        }
        .scrollable-list::-webkit-scrollbar-thumb {
            background-color: #cbd5e1; /* slate-300 */
            border-radius: 3px;
        }
        /* Styles for PWA look and feel */
        .pwa-header {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(8px);
            background-color: rgba(255, 255, 255, 0.9);
        }
        .place-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer; /* Indicate clickability for detail view */
        }
        .place-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 4px, 6px, 0.1);
        }
        .filter-active {
            box-shadow: 0 0 0 3px #4f46e5;
            background-color: #4f46e5 !important;
            color: white !important;
        }
        /* Modal Backdrop */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 50;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease;
        }
        .modal-backdrop.open {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background: white;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }
        .modal-backdrop.open .modal-content {
            transform: translateY(0);
        }
    </style>
    <!-- Minimal PWA Metadata -->
    <link rel="manifest" href="data:application/json;base64,eyJkZXNpZ24iOiJhdGhlbmlhbnMtYmVja2Rldi1wbGVhcy13YWl0LW9uLWhlcml0YWdlLXdlYi1hcHAiLCJzdGFydF91cmwiOiIuIiwic2NvcGUiOiIvIiwicG5nIjoiIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJpY29ucyI6W3sic3JjIjoiL2ljb24tMTkyLnBuZyIsInR5cGUiOiJpbWFnZS9wbmciLCJzaXplcyI6IjE5MngxOTIifSx7InNyYyI6Ii9pY29uLTUxMi5wbmciLCJ0eXBlIjoiabWFnZS9wbmciLCJzaXplcyI6IjUxMng1MTIifV0sImRlc2NyaXB0aW9uIjoiVG91cmlzbSBHdWlkZSBmb3IgTWFoYXJhc2h0cmEifQ==">
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Header (Fixed for PWA Feel) -->
    <div class="pwa-header sticky top-0 z-10 py-4 border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h1 class="text-2xl sm:text-3xl font-bold text-indigo-700">Maharashtra Untapped üè∞üåäüêÖ</h1>
            <p class="text-sm text-gray-500">Offline Guide to Local Tourism & Heritage</p>
        </div>
    </div>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Filter & Search Section -->
        <section class="mb-8 p-4 bg-white rounded-xl shadow-lg border border-gray-100">
            <h2 class="text-xl font-semibold mb-3 text-gray-700">Find Your Adventure</h2>
            <div class="flex flex-wrap gap-2 mb-4" id="filter-buttons">
                <!-- Filters will be injected here -->
            </div>
            <input type="text" id="search-input" placeholder="Search places, forts, or districts..."
                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 shadow-sm transition"
                   oninput="applyFilters()">
        </section>

        <!-- Main Content: Regional Breakdown -->
        <div id="tourism-regions" class="space-y-12">
            <!-- Regional cards and places will be injected here -->
        </div>
        
        <!-- Favorites Section -->
        <section id="favorites-section" class="mt-12 pt-8 border-t-2 border-indigo-200 hidden">
            <h2 class="text-3xl font-extrabold text-indigo-600 mb-6 flex items-center">
                <span class="mr-2">‚ù§Ô∏è</span>
                Your Favorites
            </h2>
            <div id="favorites-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Favorite places will be dynamically loaded here -->
            </div>
            <p id="no-favorites-message" class="text-gray-500 italic p-4 text-center hidden">
                You haven't added any favorite places yet. Click the heart icon on any destination to save it!
            </p>
        </section>

    </main>
    
    <!-- Detail Modal -->
    <div id="place-details-modal" class="modal-backdrop" onclick="closeModal(event)">
        <div class="modal-content w-11/12 md:w-4/5 lg:w-3/5 xl:w-1/2 rounded-xl shadow-2xl p-6 md:p-8" onclick="event.stopPropagation()">
            <div class="flex justify-end">
                <button onclick="closeModal()" class="text-gray-500 hover:text-gray-900 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div id="modal-body">
                <!-- Content will be injected here -->
            </div>
        </div>
    </div>

    <!-- JavaScript and Static Data -->
    <script>
        // --- STATIC DATA DEFINITION ---
        const MAHARASHTRA_TOURISM_DATA = [
            {
                region: "Konkan Coast",
                icon: "üåä",
                theme: "Beaches, Forts, Nature",
                color: "bg-blue-600",
                districts: ["Raigad", "Ratnagiri", "Sindhudurg"],
                places: [
                    { 
                        name: "Murud‚ÄìJanjira Fort", tags: ['fort', 'sea', 'history'], season: "Oct-Mar", distance: "45km from Alibaug", coords: [18.3072, 72.9575], 
                        description: "An incredible sea fort, unique for remaining unconquered by the Marathas, Mughals, or Portuguese. It stands majestically on an oval-shaped rock.",
                        culturalNote: "The fort represents the power of the Siddis. Its main gates are hidden and only visible when close to the fort, a tactical marvel.",
                        localFocus: "Enjoy fresh seafood (Konkani fish curry) at Murud beach shacks. Look out for the traditional fishing boats."
                    },
                    { 
                        name: "Ganpatipule", tags: ['beach', 'temple', 'pilgrimage'], season: "Nov-Feb", distance: "375km from Mumbai", coords: [17.1470, 73.2700], 
                        description: "Famous for its 400-year-old Ganesha temple where the deity is said to be self-manifested and faces west. A pristine beach wraps around the area.",
                        culturalNote: "The temple is built right on the beach, a rarity. It is a major stop on the Konkan pilgrimage circuit.",
                        localFocus: "Try the famous 'Aamras' (mango pulp) and explore the local markets for Kokum products."
                    },
                    { 
                        name: "Tarkarli Beach", tags: ['beach', 'water-sports'], season: "Oct-May", distance: "6km from Malvan", coords: [16.0357, 73.4735], 
                        description: "Known for its white sand and clear turquoise waters, making it one of the best spots for scuba diving and snorkeling in Maharashtra.",
                        culturalNote: "Malvani cuisine is highly distinct‚Äîspicy, rich in coconut, and famous for its 'Malvani Vade' (puri-like bread).",
                        localFocus: "Take a boat ride to Devbagh Sangam where the Karli River meets the Arabian Sea. Visit a local house to see the traditional Konkani architecture."
                    },
                    { 
                        name: "Sindhudurg Fort", tags: ['fort', 'sea', 'history'], season: "Nov-May", distance: "Malvan coast", coords: [16.0400, 73.4691], 
                        description: "Built by Chhatrapati Shivaji Maharaj, this sea fort covers 48 acres and remains well-preserved. It has a hidden passage and a temple dedicated to the king.",
                        culturalNote: "It took 3 years and 100 Portuguese stonemasons to complete. The foundation stone was laid on the auspicious day of November 25, 1664.",
                        localFocus: "The nearby Malvani village is known for its pottery and local handicrafts."
                    }
                ]
            },
            {
                region: "Sahyadri / Western Ghats",
                icon: "‚õ∞Ô∏è",
                theme: "Hill Stations & Treks",
                color: "bg-green-600",
                districts: ["Pune", "Raigad", "Nashik"],
                places: [
                    { 
                        name: "Matheran", tags: ['hill', 'nature', 'trek', 'unique'], season: "Jun-Sep (Monsoon)", distance: "100km from Mumbai", coords: [18.9850, 73.2700], 
                        description: "Asia‚Äôs only vehicle-free hill station, Matheran is a dense forest reserve offering panoramic views from 30+ points. Travel here by toy train.",
                        culturalNote: "The lack of vehicles preserves the 19th-century colonial charm and ensures exceptionally clean air.",
                        localFocus: "Try local chikki (a sweet peanut brittle) and honey, and experience a unique ride on a hand-pulled rickshaw."
                    },
                    { 
                        name: "Kalsubai Peak", tags: ['hill', 'trek'], season: "Oct-Feb", distance: "Highest in Maharashtra", coords: [19.5910, 73.7144], 
                        description: "The highest peak in Maharashtra (1646m), offering challenging but rewarding treks. A small temple stands at the summit.",
                        culturalNote: "The peak is named after a local deity, Kalsubai. The trek is often done overnight to view the sunrise.",
                        localFocus: "The villages near the base (like Bari) provide authentic, simple meals prepared by local families."
                    },
                    { 
                        name: "Mahabaleshwar", tags: ['hill', 'nature'], season: "All Year", distance: "120km from Pune", coords: [17.9205, 73.9782], 
                        description: "A large hill station known for its numerous viewing points, including Arthur's Seat and Wilson Point. It's the source of the Krishna River.",
                        culturalNote: "The area is famous for its strawberry farms, producing a massive percentage of India's strawberries.",
                        localFocus: "Visit a strawberry farm (especially in winter) and taste local jams and jellies. Try the corn patties."
                    }
                ]
            },
            {
                region: "Marathwada",
                icon: "üèõÔ∏è",
                theme: "History, Caves, Culture",
                color: "bg-yellow-600",
                districts: ["Aurangabad (Chh. Sambhajinagar)", "Nanded", "Latur"],
                places: [
                    { 
                        name: "Ajanta Caves", tags: ['unesco', 'history', 'culture', 'caves'], season: "Oct-Mar", distance: "100km from Aurangabad", coords: [20.5516, 75.7874], 
                        description: "30 rock-cut Buddhist cave monuments dating from the 2nd century BCE to about 480 CE, famous for their mural paintings depicting Jataka tales.",
                        culturalNote: "The caves were hidden by jungle for centuries before being accidentally rediscovered by a British officer in 1819.",
                        localFocus: "The nearby Paithani weaving centers are famous for producing exquisite silk sarees‚Äîa key local craft."
                    },
                    { 
                        name: "Ellora Caves", tags: ['unesco', 'history', 'culture', 'caves', 'temple'], season: "Oct-Mar", distance: "30km from Aurangabad", coords: [20.0270, 75.1783], 
                        description: "A UNESCO site featuring 34 monasteries and temples carved side-by-side into a cliff face, representing Buddhism, Hinduism, and Jainism.",
                        culturalNote: "Cave 16, the Kailasa Temple, is the world's largest monolithic structure, carved top-down from a single rock.",
                        localFocus: "Explore the street food in Aurangabad, known for 'Naan Qalia' (a mutton curry dish)."
                    },
                    { 
                        name: "Daulatabad (Devgiri) Fort", tags: ['fort', 'history'], season: "Nov-Feb", distance: "15km from Ellora", coords: [19.9575, 75.2052], 
                        description: "An ancient hill fortress that served as the capital of the Yadava dynasty and briefly, the Sultanate of Delhi. Its defenses are legendary.",
                        culturalNote: "The fort has complex defense mechanisms, including a dark spiral passage (Andheri) to confuse enemies.",
                        localFocus: "The region is known for Himroo and Mashru fabric weaving, a Persian-influenced craft."
                    }
                ]
            },
            {
                region: "Vidarbha",
                icon: "üêÖ",
                theme: "Wildlife, Lakes, Spiritual",
                color: "bg-red-600",
                districts: ["Nagpur", "Chandrapur", "Amravati"],
                places: [
                    { 
                        name: "Tadoba Andhari Tiger Reserve", tags: ['wildlife', 'safari'], season: "Oct-May", distance: "150km from Nagpur", coords: [20.3019, 79.3512], 
                        description: "One of India's oldest and largest national parks, known for having a high tiger population density and diverse flora and fauna.",
                        culturalNote: "The park gets its name from the local deity Taru, worshipped by the tribal people, and the Andhari River.",
                        localFocus: "Stay in eco-friendly resorts run by local communities to support the forest economy."
                    },
                    { 
                        name: "Lonar Crater Lake", tags: ['nature', 'unique'], season: "Oct-Mar", distance: "500km from Nagpur", coords: [19.9926, 76.5057], 
                        description: "A National Geo-heritage Monument, this lake was formed 52,000 years ago by a meteorite impact. Its water is both saline and alkaline.",
                        culturalNote: "The unique geology attracts scientists worldwide. Temples dating back to the Yadava era surround the crater.",
                        localFocus: "Try 'Dal Gosht' and other regional delicacies from the Buldhana district. The local temples display stunning Heamdapanthi architecture."
                    },
                    { 
                        name: "Chikhaldara Hill Station", tags: ['hill', 'nature'], season: "All Year", distance: "100km from Amravati", coords: [21.3990, 77.3480], 
                        description: "The only coffee-growing area in Maharashtra, located in the Satpura Range. It offers deep valleys and scenic viewpoints.",
                        culturalNote: "Legend says Bhima killed the villainous Keechaka here and threw him into the valley (Keechakdara), hence the name.",
                        localFocus: "Sample locally grown coffee and forest produce, including honey and various medicinal plants."
                    }
                ]
            },
            {
                region: "Desh & Central Maharashtra",
                icon: "üõï",
                theme: "Pilgrimage & Heritage",
                color: "bg-purple-600",
                districts: ["Pune", "Nashik", "Kolhapur", "Satara"],
                places: [
                    { 
                        name: "Shirdi (Sai Baba)", tags: ['pilgrimage'], season: "All Year", distance: "185km from Pune", coords: [19.7644, 74.4752], 
                        description: "Home to the famous Shri Sai Baba Samadhi Mandir, attracting millions of devotees annually from all faiths.",
                        culturalNote: "The town revolves entirely around the Sai Baba temple and its charitable activities.",
                        localFocus: "Visit the Dwarkamai mosque where Sai Baba lived, and the Chawadi. Simple, vegetarian food is a staple."
                    },
                    { 
                        name: "Pandharpur (Vitthal Rukmini)", tags: ['pilgrimage', 'culture'], season: "All Year (Wari: Jun-Jul)", distance: "200km from Pune", coords: [17.6713, 75.3197], 
                        description: "The most important pilgrimage site in Maharashtra for the Varkari sect, dedicated to Lord Vitthal (a form of Krishna) and his consort Rukmini.",
                        culturalNote: "The annual 'Wari' pilgrimage, where devotees walk hundreds of kilometers, is a major cultural event in Maharashtra.",
                        localFocus: "Try the local sweets like 'Khadaksev' and observe the traditional worship rituals by the Chandrabhaga river."
                    },
                    { 
                        name: "Trimbakeshwar Jyotirlinga", tags: ['temple', 'pilgrimage'], season: "All Year", distance: "30km from Nashik", coords: [19.9320, 73.5350], 
                        description: "One of the twelve Jyotirlingas, located at the source of the Godavari River. The temple is an example of classic Nagara architecture.",
                        culturalNote: "The Shiva linga here has three faces representing Brahma, Vishnu, and Mahesh (Shiva).",
                        localFocus: "The region is known for its grape and wine production‚Äîvisit a vineyard if time permits. Also, observe the unique temple rituals."
                    }
                ]
            }
        ];

        const ALL_TAGS = ['beach', 'fort', 'nature', 'sea', 'water-sports', 'hill', 'trek', 'unesco', 'history', 'culture', 'temple', 'pilgrimage', 'wildlife', 'safari', 'unique', 'festival', 'caves'];
        const FAVORITES_STORAGE_KEY = 'mah_tour_favorites';

        let favorites = new Set();
        let activeFilter = null;

        // --- UTILITY FUNCTIONS ---

        function createSafeId(name) {
            // Convert to lowercase, replace any sequence of non-alphanumeric characters (including space and /) with a single hyphen,
            // and remove leading/trailing hyphens.
            return name.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-+|-+$/g, '');
        }

        // Finds a place object by its unique identifier (RegionName-PlaceName)
        function findPlaceByIdentifier(identifier) {
            const [regionName, placeName] = identifier.split('-');
            const region = MAHARASHTRA_TOURISM_DATA.find(r => r.region === regionName);
            if (region) {
                return region.places.find(p => p.name === placeName);
            }
            return null;
        }

        // --- FAVORITES LOGIC ---

        function getFavorites() {
            try {
                const stored = localStorage.getItem(FAVORITES_STORAGE_KEY);
                return stored ? new Set(JSON.parse(stored)) : new Set();
            } catch (e) {
                console.error("Error reading favorites from localStorage", e);
                return new Set();
            }
        }

        function saveFavorites() {
            try {
                localStorage.setItem(FAVORITES_STORAGE_KEY, JSON.stringify(Array.from(favorites)));
            } catch (e) {
                console.error("Error saving favorites to localStorage", e);
            }
        }

        function toggleFavorite(event, placeIdentifier) {
            event.stopPropagation(); // Prevent card click from opening the modal
            if (favorites.has(placeIdentifier)) {
                favorites.delete(placeIdentifier);
            } else {
                favorites.add(placeIdentifier);
            }
            saveFavorites();
            renderAll(); // Re-render to update heart icons and the favorites list
        }

        // --- MODAL LOGIC ---

        function closeModal(event) {
            const modal = document.getElementById('place-details-modal');
            // Only close if clicking the backdrop or the close button
            if (!event || event.target === modal) {
                modal.classList.remove('open');
                document.body.style.overflow = ''; // Restore scrolling
            }
        }

        function showPlaceDetails(place, regionName) {
            const modal = document.getElementById('place-details-modal');
            const modalBody = document.getElementById('modal-body');
            const placeIdentifier = `${regionName}-${place.name}`;
            const isFavorite = favorites.has(placeIdentifier);
            
            // Random image placeholder generation
            const seed = place.name.split(' ').join('');
            const imageUrl = `https://placehold.co/800x400/312e81/ffffff?text=${seed}`;
            
            modalBody.innerHTML = `
                <div class="space-y-6">
                    <!-- Title and Favorite -->
                    <div class="flex items-start justify-between border-b pb-4">
                        <h2 class="text-3xl font-extrabold text-indigo-700">${place.name}</h2>
                        <button onclick="toggleFavorite(event, '${placeIdentifier}')" 
                                class="p-2 rounded-full ${isFavorite ? 'text-red-500 hover:text-red-700' : 'text-gray-400 hover:text-red-500'} transition-colors duration-150"
                                title="${isFavorite ? 'Remove from Favorites' : 'Add to Favorites'}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="${isFavorite ? 'currentColor' : 'none'}" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7">
                                <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>
                            </svg>
                        </button>
                    </div>

                    <!-- Image Placeholder -->
                    <img src="${imageUrl}" alt="${place.name}" class="w-full h-auto max-h-96 object-cover rounded-xl shadow-lg" onerror="this.src='https://placehold.co/800x400/6366f1/ffffff?text=Image+Missing'">
                    
                    <!-- Overview -->
                    <div>
                        <h3 class="text-2xl font-semibold text-gray-800 mb-2 border-b pb-1">Overview</h3>
                        <p class="text-gray-600">${place.description}</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Cultural Notes -->
                        <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <h4 class="text-xl font-semibold text-indigo-600 flex items-center mb-2">
                                <span class="mr-2">üé≠</span> Cultural & Heritage Notes
                            </h4>
                            <p class="text-gray-600">${place.culturalNote}</p>
                        </div>
                        
                        <!-- Local Tourism Focus -->
                        <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <h4 class="text-xl font-semibold text-indigo-600 flex items-center mb-2">
                                <span class="mr-2">üçõ</span> Local Focus (Cuisine & Craft)
                            </h4>
                            <p class="text-gray-600">${place.localFocus}</p>
                        </div>
                    </div>

                    <!-- Offline Navigation Section -->
                    <div class="bg-indigo-50 p-4 rounded-lg border border-indigo-200">
                        <h3 class="text-2xl font-semibold text-indigo-700 mb-3 flex items-center">
                            <span class="mr-2">üìç</span> Offline Navigation Reference
                        </h3>
                        <p class="text-sm text-indigo-800 mb-2">
                            This data is fully available offline. In a full PWA install, these coordinates could be fed into a local map viewer (OpenStreetMap tiles cached via Service Worker).
                        </p>
                        <div class="bg-white p-3 rounded-md text-gray-700 font-mono text-sm shadow-inner">
                            <strong>Coordinates:</strong> ${place.coords ? place.coords.join(', ') : 'N/A'}
                        </div>
                        <p class="text-sm text-gray-500 mt-2">Distance from nearest city: ${place.distance}</p>
                    </div>
                    
                    <!-- Tags -->
                    <div class="flex flex-wrap gap-2 pt-4 border-t">
                        ${place.tags.map(tag => `<span class="bg-indigo-100 text-indigo-700 text-sm font-semibold px-3 py-1 rounded-full">${tag}</span>`).join('')}
                    </div>
                </div>
            `;

            modal.classList.add('open');
            document.body.style.overflow = 'hidden'; // Disable background scrolling
        }

        // --- RENDERING LOGIC ---

        function renderFilterButtons() {
            const container = document.getElementById('filter-buttons');
            container.innerHTML = `<button onclick="setActiveFilter(null)" class="filter-btn ${!activeFilter ? 'filter-active' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'} px-4 py-2 rounded-full text-sm font-medium transition duration-150">All Destinations</button>`;

            ALL_TAGS.forEach(tag => {
                const button = document.createElement('button');
                button.textContent = `#${tag}`;
                button.className = `filter-btn px-4 py-2 rounded-full text-sm font-medium transition duration-150 ${activeFilter === tag ? 'filter-active' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`;
                button.onclick = () => setActiveFilter(tag);
                container.appendChild(button);
            });
        }

        function setActiveFilter(tag) {
            activeFilter = tag;
            renderFilterButtons();
            renderTourismRegions();
            renderFavoritesList();
        }

        function renderPlaceCard(place, regionName) {
            const placeIdentifier = `${regionName}-${place.name}`;
            const isFavorite = favorites.has(placeIdentifier);
            
            // Random image placeholder generation (using a unique seed based on the place name)
            const seed = place.name.split(' ').join('');
            const imageUrl = `https://placehold.co/400x250/312e81/ffffff?text=${seed}`;
            
            const card = document.createElement('div');
            card.className = "place-card bg-white p-5 rounded-xl shadow-md flex flex-col justify-between border border-gray-100";
            card.setAttribute('data-region', regionName);
            card.setAttribute('data-place', place.name);
            card.onclick = () => showPlaceDetails(place, regionName); // Added click handler
            
            card.innerHTML = `
                <div class="mb-3">
                    <img src="${imageUrl}" alt="${place.name}" class="w-full h-32 object-cover rounded-lg mb-3" onerror="this.src='https://placehold.co/400x250/6366f1/ffffff?text=Image+Missing'">
                    <div class="flex items-start justify-between">
                        <h3 class="text-xl font-bold text-gray-800">${place.name}</h3>
                        <button onclick="toggleFavorite(event, '${placeIdentifier}')" 
                                class="p-1 rounded-full ${isFavorite ? 'text-red-500 hover:text-red-700' : 'text-gray-400 hover:text-red-500'} transition-colors duration-150"
                                title="${isFavorite ? 'Remove from Favorites' : 'Add to Favorites'}">
                            <!-- Heart Icon (lucide-react equivalent SVG) -->
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="${isFavorite ? 'currentColor' : 'none'}" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6">
                                <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <div>
                    <p class="text-sm text-gray-600 mb-2">Region: <span class="font-medium">${regionName}</span></p>
                    <p class="text-sm text-gray-600 mb-2">Best Season: <span class="font-medium">${place.season}</span></p>
                    <div class="flex flex-wrap gap-1">
                        ${place.tags.slice(0, 3).map(tag => `<span class="bg-indigo-100 text-indigo-700 text-xs font-semibold px-2 py-0.5 rounded-full">${tag}</span>`).join('')}
                        ${place.tags.length > 3 ? `<span class="bg-gray-200 text-gray-600 text-xs font-semibold px-2 py-0.5 rounded-full">+${place.tags.length - 3} more</span>` : ''}
                    </div>
                </div>
            `;
            return card;
        }

        function renderTourismRegions() {
            const container = document.getElementById('tourism-regions');
            container.innerHTML = '';
            const searchText = document.getElementById('search-input').value.toLowerCase();
            let totalVisiblePlaces = 0;

            MAHARASHTRA_TOURISM_DATA.forEach(regionData => {
                const regionDiv = document.createElement('div');
                
                // Filter places based on activeFilter and search text
                const filteredPlaces = regionData.places.filter(place => {
                    const tagMatch = !activeFilter || place.tags.includes(activeFilter);
                    const searchMatch = !searchText || 
                                        place.name.toLowerCase().includes(searchText) || 
                                        regionData.region.toLowerCase().includes(searchText) ||
                                        regionData.districts.some(d => d.toLowerCase().includes(searchText));
                    return tagMatch && searchMatch;
                });
                
                if (filteredPlaces.length === 0) {
                    return; // Skip rendering region if no places match
                }
                
                totalVisiblePlaces += filteredPlaces.length;

                // Create a safe ID for the region container
                const regionSafeId = createSafeId(regionData.region);

                regionDiv.className = "mb-10";
                regionDiv.innerHTML = `
                    <div class="flex items-center justify-between mb-4 ${regionData.color} text-white p-4 rounded-xl shadow-lg">
                        <h2 class="text-2xl font-extrabold flex items-center">
                            <span class="text-3xl mr-3">${regionData.icon}</span>
                            ${regionData.region}
                        </h2>
                        <span class="text-sm font-medium opacity-80 hidden sm:block">${regionData.theme}</span>
                    </div>
                    <div class="text-sm text-gray-600 mb-4 p-2 bg-gray-100 rounded-lg">
                        <span class="font-bold">Districts:</span> ${regionData.districts.join(', ')}
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="region-${regionSafeId}-places">
                        <!-- Place cards will be injected here -->
                    </div>
                `;
                
                // Use the safe ID in querySelector
                const placesContainer = regionDiv.querySelector(`#region-${regionSafeId}-places`);
                filteredPlaces.forEach(place => {
                    placesContainer.appendChild(renderPlaceCard(place, regionData.region));
                });
                
                container.appendChild(regionDiv);
            });
            
            if (totalVisiblePlaces === 0) {
                container.innerHTML = `
                    <div class="text-center p-12 bg-white rounded-xl shadow-lg mt-8">
                        <p class="text-2xl font-bold text-gray-700 mb-2">No Results Found</p>
                        <p class="text-gray-500">Try adjusting your filters or search terms.</p>
                    </div>
                `;
            }
        }

        function renderFavoritesList() {
            const container = document.getElementById('favorites-list');
            const section = document.getElementById('favorites-section');
            const noMessage = document.getElementById('no-favorites-message');
            container.innerHTML = '';
            
            if (favorites.size === 0) {
                section.classList.add('hidden');
                noMessage.classList.remove('hidden');
                return;
            }

            section.classList.remove('hidden');
            noMessage.classList.add('hidden');
            
            let favoritePlaces = [];
            MAHARASHTRA_TOURISM_DATA.forEach(regionData => {
                regionData.places.forEach(place => {
                    const placeIdentifier = `${regionData.region}-${place.name}`;
                    if (favorites.has(placeIdentifier)) {
                        favoritePlaces.push({ place, regionName: regionData.region });
                    }
                });
            });

            // If a filter is active, apply it to the favorites list
            const filteredFavorites = favoritePlaces.filter(({ place }) => {
                const searchInput = document.getElementById('search-input').value.toLowerCase();
                const tagMatch = !activeFilter || place.tags.includes(activeFilter);
                const searchMatch = !searchInput || place.name.toLowerCase().includes(searchInput);
                return tagMatch && searchMatch;
            });
            
            if (filteredFavorites.length === 0 && favorites.size > 0) {
                 container.innerHTML = `<p class="text-gray-500 italic p-4 text-center col-span-full">
                    No favorites match the current search or filter criteria.
                </p>`;
            } else {
                filteredFavorites.forEach(({ place, regionName }) => {
                    container.appendChild(renderPlaceCard(place, regionName));
                });
            }
        }
        
        // --- EVENT HANDLERS ---
        
        function applyFilters() {
            renderTourismRegions();
            renderFavoritesList();
        }

        function renderAll() {
            renderFilterButtons();
            applyFilters();
        }

        // --- INITIALIZATION ---

        document.addEventListener('DOMContentLoaded', () => {
            // 1. Load favorites from localStorage
            favorites = getFavorites();
            
            // 2. Render all components
            renderAll();
            
            // 3. Register Service Worker (for PWA compliance, though functionality may be limited in iframe)
            if ('serviceWorker' in navigator) {
                // This is purely for compliance with the PWA requirement; actual SW functionality is complex in this environment.
                console.log('Service Worker is available. App is structured for offline use.');
                // navigator.serviceWorker.register('/sw.js'); // Would register the SW file here
            }
        });
    </script>

</body>
</html>
